plugins {
    id 'buildlogic.java-conventions'
    id 'org.springframework.boot' version '3.0.7'
    id 'com.netflix.dgs.codegen' version '6.0.3'
    id 'io.spring.dependency-management' version '1.1.4'
}

repositories {
    gradlePluginPortal()
}

dependencies {
    api project(':vino-baselib')
    annotationProcessor 'org.projectlombok:lombok'
    compileOnly 'org.projectlombok:lombok'
    api 'org.springframework.boot:spring-boot-starter-web'
    api 'org.springframework.boot:spring-boot-starter-data-redis'
    api 'org.springframework.boot:spring-boot-starter-cache'
    api 'org.springframework.boot:spring-boot-starter-data-mongodb'
    api 'org.springframework.boot:spring-boot-starter-data-jpa'
    api 'org.springframework.boot:spring-boot-starter-validation'
    api libs.modelmapper.spring
    api libs.flyway.core
    api libs.netflix.graphql.dgs.spring.boot.starter
    api libs.netflix.graphql.dgs.extended.scalars
    api libs.netflix.graphql.dgs.pagination
    api 'javax.validation:validation-api:2.0.1.Final'

    runtimeOnly 'com.mysql:mysql-connector-j'
    runtimeOnly 'org.postgresql:postgresql'

    testAnnotationProcessor 'org.projectlombok:lombok'
    testImplementation libs.embed.mongo.spring30x
    testImplementation libs.jedis.mock
    testImplementation libs.h2database
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    testImplementation 'io.rest-assured:rest-assured:5.3.0'

}

description = 'vino-demo-svc'

generateJava {
    schemaPaths = ["${projectDir}/src/main/resources/schema/schema.graphqls"]
    packageName = 'net.vino9.vino.demo.generated'
    generateClient = false
    typeMapping = ['BigDecimal': 'java.math.BigDecimal']
}

//compileJava.dependsOn 'generateJava'
//
//print "============== ${projectDir}/build/generated/sources/dgs-codegen"
//sourceSets.main.java.srcDir "${projectDir}/build/generated/sources/dgs-codegen"
